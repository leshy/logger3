(function(){
  var ref$, lmap, keys, values, isEmpty, defaultsDeep, pick, omit, mapKeys, mapValues, net, colors, os, util, h, Backbone, subscriptionMan, _, objToPairs, map, fold1, first, flatten, hashColors, Influx, redis, db, Fluent, Sails, Udp, Tcp, tcpServer;
  ref$ = require('lodash'), lmap = ref$.map, keys = ref$.keys, values = ref$.values, isEmpty = ref$.isEmpty, defaultsDeep = ref$.defaultsDeep, pick = ref$.pick, omit = ref$.omit, mapKeys = ref$.mapKeys, mapValues = ref$.mapValues;
  net = require('net');
  colors = require('colors');
  os = require('os');
  util = require('util');
  h = require('helpers');
  Backbone = require('backbone4000');
  subscriptionMan = require('subscriptionman2');
  _ = require('underscore');
  ref$ = require('prelude-ls'), objToPairs = ref$.objToPairs, map = ref$.map, fold1 = ref$.fold1, keys = ref$.keys, values = ref$.values, first = ref$.first, flatten = ref$.flatten;
  hashColors = [colors.green, colors.rainbow, colors.yellow, colors.red, colors.blue, colors.cyan, colors.magenta, colors.grey, colors.white];
  exports.Console = Backbone.Model.extend4000({
    name: 'console',
    initialize: function(){
      return this.startTime = process.hrtime()[0];
    },
    parseTags: function(tags){
      return map(function(arg$){
        var tag, value, paintString;
        tag = arg$[0], value = arg$[1];
        paintString = function(value, name){
          if (value === 'fail' || value === 'error' || value === 'err' || value === 'warning' || value === 'warn' || value === '403') {
            return colors.red(value);
          }
          if (value === 'done' || value === 'pass' || value === 'ok' || value === 'success' || value === 'completed' || value === '200') {
            return colors.green(value);
          }
          if (value === 'exec' || value === 'task') {
            return colors.magenta(value);
          }
          if (value === 'GET' || value === 'POST' || value === 'login' || value === 'in' || value === 'out' || value === 'skip' || value === '404') {
            return colors.magenta(value);
          }
          if (name === 'pid') {
            value = hashColors[Number(value) % hashColors.length](String(value));
          }
          return colors.yellow(value);
        };
        if (value === true) {
          return paintString(tag);
        } else {
          return colors.gray(tag) + ":" + paintString(value, tag);
        }
      })(
      objToPairs(
      tags));
    },
    log: function(logEvent){
      var hrtime, tags;
      hrtime = process.hrtime();
      tags = this.parseTags(logEvent.tags);
      return console.log(colors.magenta(process.pid), colors.green((hrtime[0] - this.startTime) + "." + hrtime[1]) + "\t " + tags.join(', ') + "\t" + (logEvent.msg || "-"));
    }
  });
  Influx = exports.Influx = Backbone.Model.extend4000({
    name: 'influx',
    initialize: function(settings){
      var influx;
      settings == null && (settings = {});
      this.settings = {
        connection: {
          host: 'localhost',
          port: 8086,
          protocol: 'http',
          username: 'node',
          database: 'logger'
        },
        tagFields: {
          module: true,
          app: true
        }
      };
      this.settings = defaultsDeep(settings, this.settings);
      this.tagFields = keys(this.settings.tagFields);
      influx = require('influx').InfluxDB;
      return this.client = new influx(this.settings.connection);
    },
    log: function(logEvent){
      var removeForbidden, flattenVals, data, tags;
      removeForbidden = function(it){
        var forbiddenKeys;
        forbiddenKeys = {
          time: true,
          measurement: true
        };
        return mapKeys(it, function(val, key){
          if (forbiddenKeys[key]) {
            return "_" + key;
          } else {
            return key;
          }
        });
      };
      flattenVals = function(it){
        return mapValues(it, function(val, key){
          var ref$;
          if (val == null) {
            return "";
          }
          if ((ref$ = val != null ? val.constructor : void 8) === Object || ref$ === Array) {
            return JSON.stringify(val);
          } else {
            return val;
          }
        });
      };
      data = import$({}, flattenVals(removeForbidden(omit(import$(logEvent.data, logEvent.tags), this.tagFields))));
      tags = removeForbidden(pick(logEvent.tags, this.tagFields));
      return this.client.writePoints([{
        measurement: "log",
        fields: data,
        tags: tags,
        time: new Date()
      }])['catch'](function(it){
        return console.error(colors.red("error"), it.message);
      });
    }
  });
  redis = exports.Redis = Backbone.Model.extend4000({
    name: 'redis',
    initialize: function(settings){
      var ref$, redis;
      settings == null && (settings = {});
      this.settings = {
        connection: {
          host: 'localhost',
          port: 6379
        },
        channel: 'log',
        channelFields: {
          pid: true,
          module: true,
          app: true
        }
      };
      this.settings = defaultsDeep(settings, this.settings);
      this.channel = (ref$ = this.settings).channel;
      this.channelFields = ref$.channelFields;
      redis = require('redis');
      return this.client = redis.createClient(this.settings.connection);
    },
    log: function(logEvent){
      var channelName;
      channelName = this.channel + "/" + lmap(pick(logEvent.tags, keys(this.channelFields)), function(value, key){
        return key + ":" + value;
      }).join("/");
      return this.client.publish(channelName, JSON.stringify(logEvent));
    }
  });
  db = exports.db = exports.Mongo = Backbone.Model.extend4000({
    name: 'db',
    initialize: function(settings){
      var this$ = this;
      this.settings = import$({
        name: 'log',
        collection: 'log',
        host: 'localhost',
        port: 27017,
        tail: h.Day * 30 * 6
      }, settings);
      this.mongodb = require('mongodb');
      this.db = new this.mongodb.Db(this.settings.name, new this.mongodb.Server(this.settings.host || 'localhost', this.settings.port || 27017), {
        safe: true
      });
      this.db.open();
      this.c = this.db.collection(this.settings.collection);
      this.removeTail();
      return setInterval(function(){
        return this$.removeTail();
      }, h.Hour);
    },
    removeTail: function(cb){
      var splitPoint;
      splitPoint = Math.round((new Date().getTime() - this.settings.tail) / 1000).toString(16);
      return this.c.remove({
        _id: {
          $lt: this.mongodb.ObjectId(splitPoint + "0000000000000000")
        }
      }, cb);
    },
    log: function(logEvent){
      var entry;
      entry = h.extendm({
        time: new Date()
      }, logEvent);
      if (isEmpty(entry.data)) {
        delete entry.data;
      }
      return this.c.insert(entry);
    }
  });
  Fluent = exports.Fluent = Backbone.Model.extend4000({
    name: 'fluent',
    initialize: function(settings){
      this.settings = settings != null
        ? settings
        : {
          host: 'localhost',
          name: 'logger',
          port: 24224
        };
      this.logger = require('fluent-logger');
      return this.logger.configure(os.hostname() + '.n.' + this.settings.name, {
        host: this.settings.host,
        port: this.settings.port
      });
    },
    log: function(logEvent){
      return this.logger.emit(keys(logEvent.tags).join('.'), h.extend(this.settings.extendPacket || {}, logEvent.data));
    }
  });
  Sails = exports.Sails = Backbone.Model.extend4000({
    name: 'sails',
    initialize: function(settings){
      this.settings = settings != null
        ? settings
        : {
          sails: false
        };
      if (!this.settings.sails) {
        throw "Sails instance missing";
      }
      return this.sails = this.settings.sails;
    },
    log: function(logEvent){
      this.sails.sockets.broadcast('log', 'log', logEvent);
      return this.sails.emit('log', logEvent);
    }
  });
  Udp = exports.Udp = Backbone.Model.extend4000({
    name: 'udp',
    initialize: function(settings){
      var UdpGun;
      this.settings = settings != null
        ? settings
        : {
          host: 'localhost',
          port: 6000
        };
      UdpGun = require('udp-client');
      this.gun = new UdpGun(this.settings.port, this.settings.host);
      return this.hostname = os.hostname();
    },
    log: function(logEvent){
      return this.gun.send(new Buffer(JSON.stringify(_.extend({
        type: 'nodelogger',
        host: this.hostname
      }, this.settings.extendPacket || {}, {
        data: logEvent.data,
        tags: keys(logEvent.tags)
      }))));
    }
  });
  Tcp = exports.Tcp = Backbone.Model.extend4000({
    name: 'tcp',
    initialize: function(settings){
      var reconnecto, nssocketClient;
      this.settings = settings != null
        ? settings
        : {
          host: 'localhost',
          port: 6001
        };
      reconnecto = require('lweb3/transports/reconnecto').reconnecto;
      nssocketClient = require('lweb3/transports/client/nssocket').nssocketClient;
      return this.connection = new reconnecto({
        defaultChannelClass: nssocketClient.extend4000({
          defaults: {
            host: this.settings.host,
            port: this.settings.port,
            logger: this.settings.logger
          }
        })
      });
    },
    log: function(logEvent){
      return this.connection.send(_.extend({
        type: 'nodelogger',
        host: this.hostname
      }, this.settings.extendPacket || {}, {
        data: logEvent.data,
        tags: logEvent.tags
      }));
    }
  });
  tcpServer = exports.tcpServer = Backbone.Model.extend4000({
    name: 'tcpServer',
    initialize: function(settings){
      var cnt, server, this$ = this;
      this.settings = settings != null
        ? settings
        : {
          port: 7000,
          host: '0.0.0.0'
        };
      cnt = 0;
      this.clients = {};
      server = net.createServer(function(socket){
        var id;
        id = cnt++;
        this$.clients[id] = socket;
        socket.on('close', function(){
          var ref$, ref1$;
          return ref1$ = (ref$ = this$.clients)[id], delete ref$[id], ref1$;
        });
        return socket.on('error', function(){
          var ref$, ref1$;
          return ref1$ = (ref$ = this$.clients)[id], delete ref$[id], ref1$;
        });
      });
      return server.listen(this.settings.port, this.settings.host);
    },
    log: function(logEvent){
      var this$ = this;
      try {
        return map(function(client){
          return client.write(JSON.stringify(_.extend({
            host: this$.hostname
          }, this$.settings.extendPacket || {}, {
            data: logEvent.data,
            tags: keys(logEvent.tags)
          })) + "\n");
        })(
        values(
        this.clients));
      } catch (e$) {}
    }
  });
  module.exports = import$(import$(require('./index'), require('./shared')), module.exports);
  function import$(obj, src){
    var own = {}.hasOwnProperty;
    for (var key in src) if (own.call(src, key)) obj[key] = src[key];
    return obj;
  }
}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2xlc2gvY29kaW5nL3Jlc2JvdS9zZXJ2ZXJzaWRlL25vZGVfbW9kdWxlcy9sb2dnZXIzL3NlcnZlci5scyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztFQU1FLElBQUEsR0FBQSxPQUFBLENBQUEsUUFBQSxDQUFBLEVBQWUsSUFBZixDQUFBLENBQUEsQ0FBQSxJQUFBLENBQVUsR0FBVixFQUFxQixJQUFyQixDQUFBLENBQUEsQ0FBQSxJQUFBLENBQXFCLElBQXJCLEVBQTJCLE1BQTNCLENBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBMkIsTUFBM0IsRUFBbUMsT0FBbkMsQ0FBQSxDQUFBLENBQUEsSUFBQSxDQUFtQyxPQUFuQyxFQUE0QyxZQUE1QyxDQUFBLENBQUEsQ0FBQSxJQUFBLENBQTRDLFlBQTVDLEVBQTBELElBQTFELENBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBMEQsSUFBMUQsRUFBZ0UsSUFBaEUsQ0FBQSxDQUFBLENBQUEsSUFBQSxDQUFnRSxJQUFoRSxFQUFzRSxPQUF0RSxDQUFBLENBQUEsQ0FBQSxJQUFBLENBQXNFLE9BQXRFLEVBQStFLFNBQS9FLENBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBK0U7RUFFL0UsR0FBQSxDQUFBLENBQUEsQ0FBQSxPQUFBLENBQUEsS0FBQTtFQUNBLE1BQUEsQ0FBQSxDQUFBLENBQUEsT0FBQSxDQUFBLFFBQUE7RUFDQSxFQUFBLENBQUEsQ0FBQSxDQUFBLE9BQUEsQ0FBQSxJQUFBO0VBQ0EsSUFBQSxDQUFBLENBQUEsQ0FBQSxPQUFBLENBQUEsTUFBQTtFQUVTLENBQVQsQ0FBQSxDQUFBLENBQUEsT0FBQSxDQUFBLFNBQUE7RUFFYyxRQUFkLENBQUEsQ0FBQSxDQUFBLE9BQUEsQ0FBQSxjQUFBO0VBQ2tCLGVBQWxCLENBQUEsQ0FBQSxDQUFBLE9BQUEsQ0FBQSxrQkFBQTtFQUNZLENBQVosQ0FBQSxDQUFBLENBQUEsT0FBQSxDQUFBLFlBQUE7RUFHRixJQUFBLEdBQTRELE9BQTVELENBQW9FLFlBQUEsQ0FB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LElBQXNHLEVBQWhHLEtBQUMsQ0FBQSxRQUErRjtBQUFBLFVBQXhHLENBQXdHLEVBQWxGLEtBQUMsQ0FBQSxRQUFRLENBQUMsWUFBYSxDQUFBLEVBQUEsQ0FBRyxFQUF3RCxFQUFuRCxDQUFtRDtBQUFBLFlBQWpELElBQWlELEVBQTNDLFFBQVEsQ0FBQyxJQUFrQyxDQUFBO0FBQUEsWUFBNUIsSUFBNEIsRUFBdEIsSUFBc0IsQ0FBakIsUUFBUSxDQUFDLElBQVQsQ0FBaUI7QUFBQSxVQUFuRCxDQUFyRCxDQUFWLENBQWtILENBQUEsQ0FBQSxDQUFNLElBQXRJO1NBRFI7UUFESjtRQURMLElBQUMsQ0FBQTs7O0VBZEwsQ0FBQTtFQW1CRixNQUFNLENBQUMsT0FBUSxDQUFBLENBQUEsaUJBQUUsUUFBUSxTQUFELEdBQWdCLFFBQVEsVUFBRCxJQUFpQixNQUFNLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIjIGF1dG9jb21waWxlXG4jXG4jIHRoaXMgc2hvdWxkIHVzZSBzb21lIHBsdWdpbiBzeXN0ZW0uIGRpZmZlcmVudCBvdXRwdXRzIGhhdmUgdmVyeSBkaWZmZXJuZXQgYW5kIGJlZWZ5IGRlcGVuZGVuY2llc1xuIyBjaGVjayBsZWdvIGJ1dCBhbHNvIGh0dHBzOi8vZ2l0aHViLmNvbS9jOS9hcmNoaXRlY3RcblxucmVxdWlyZSEgeyBcbiAgbG9kYXNoOiB7IG1hcDogbG1hcCwga2V5cywgdmFsdWVzLCBpc0VtcHR5LCBkZWZhdWx0c0RlZXAsIHBpY2ssIG9taXQsIG1hcEtleXMsIG1hcFZhbHVlcyB9XG4gIFxuICBuZXRcbiAgY29sb3JzXG4gIG9zXG4gIHV0aWxcblxuICBoZWxwZXJzOiBoXG5cbiAgYmFja2JvbmU0MDAwOiBCYWNrYm9uZSAgXG4gIHN1YnNjcmlwdGlvbm1hbjI6IHN1YnNjcmlwdGlvbk1hblxuICB1bmRlcnNjb3JlOiAnXydcbn1cblxue29iai10by1wYWlycywgbWFwLCBmb2xkMSwga2V5cywgdmFsdWVzLCBmaXJzdCwgZmxhdHRlbiB9ID0gcmVxdWlyZSAncHJlbHVkZS1scydcblxuXG5cbmhhc2hDb2xvcnMgPSBbIGNvbG9ycy5ncmVlbiwgY29sb3JzLnJhaW5ib3csIGNvbG9ycy55ZWxsb3csIGNvbG9ycy5yZWQsIGNvbG9ycy5ibHVlLCBjb2xvcnMuY3lhbiwgY29sb3JzLm1hZ2VudGEsIGNvbG9ycy5ncmV5LCBjb2xvcnMud2hpdGUgXVxuXG5leHBvcnRzLkNvbnNvbGUgPSBCYWNrYm9uZS5Nb2RlbC5leHRlbmQ0MDAwIGRvXG4gICAgbmFtZTogJ2NvbnNvbGUnXG4gICAgaW5pdGlhbGl6ZTogLT4gQHN0YXJ0VGltZSA9IHByb2Nlc3MuaHJ0aW1lKClbMF1cbiAgICBwYXJzZVRhZ3M6ICh0YWdzKSAtPlxuICAgICAgdGFnc1xuICAgICAgfD4gb2JqLXRvLXBhaXJzXG4gICAgICB8PiBtYXAgKFt0YWcsIHZhbHVlXSkgLT5cbiAgICAgICAgXG4gICAgICAgIHBhaW50U3RyaW5nID0gKHZhbHVlLCBuYW1lKSAtPlxuICAgICAgICAgIGlmIHZhbHVlIGluIDxbIGZhaWwgZXJyb3IgZXJyIHdhcm5pbmcgd2FybiA0MDMgXT4gdGhlbiByZXR1cm4gY29sb3JzLnJlZCB2YWx1ZVxuICAgICAgICAgIGlmIHZhbHVlIGluIDxbIGRvbmUgcGFzcyBvayBzdWNjZXNzIGNvbXBsZXRlZCAyMDAgXT4gdGhlbiByZXR1cm4gY29sb3JzLmdyZWVuIHZhbHVlXG4gICAgICAgICAgaWYgdmFsdWUgaW4gPFsgZXhlYyB0YXNrIF0+IHRoZW4gcmV0dXJuIGNvbG9ycy5tYWdlbnRhIHZhbHVlXG4gICAgICAgICAgaWYgdmFsdWUgaW4gPFsgR0VUIFBPU1QgbG9naW4gaW4gb3V0IHNraXAgNDA0IF0+IHRoZW4gcmV0dXJuIGNvbG9ycy5tYWdlbnRhIHZhbHVlXG4gICAgICAgICAgaWYgbmFtZSBpcyAncGlkJyB0aGVuIHZhbHVlID0gaGFzaENvbG9yc1sgTnVtYmVyKHZhbHVlKSAlIGhhc2hDb2xvcnMubGVuZ3RoIF0gU3RyaW5nIHZhbHVlXG4gICAgICAgICAgcmV0dXJuIGNvbG9ycy55ZWxsb3cgdmFsdWVcblxuICAgICAgICBpZiB2YWx1ZSBpcyB0cnVlIHRoZW4gcGFpbnRTdHJpbmcgdGFnXG4gICAgICAgIGVsc2UgXCIje2NvbG9ycy5ncmF5IHRhZ306I3twYWludFN0cmluZyB2YWx1ZSwgdGFnfVwiXG5cbiAgICBsb2c6IChsb2dFdmVudCkgLT5cbiAgICAgIGhydGltZSA9IHByb2Nlc3MuaHJ0aW1lKClcbiAgICAgIHRhZ3MgPSBAcGFyc2VUYWdzIGxvZ0V2ZW50LnRhZ3NcbiAgICAgIGNvbnNvbGUubG9nIGNvbG9ycy5tYWdlbnRhKHByb2Nlc3MucGlkKSwgY29sb3JzLmdyZWVuKFwiI3tocnRpbWVbMF0gIC0gQHN0YXJ0VGltZX0uI3tocnRpbWVbMV19XCIpICsgXCJcXHQgXCIgKyB0YWdzLmpvaW4oJywgJykgKyBcIlxcdFwiICsgKGxvZ0V2ZW50Lm1zZyBvciBcIi1cIilcblxuXG5JbmZsdXggPSBleHBvcnRzLkluZmx1eCA9IEJhY2tib25lLk1vZGVsLmV4dGVuZDQwMDAgZG9cbiAgbmFtZTogJ2luZmx1eCdcbiAgaW5pdGlhbGl6ZTogKHNldHRpbmdzPXt9KSAtPlxuXG4gICAgQHNldHRpbmdzID0gZG9cbiAgICAgIGNvbm5lY3Rpb246IFxuICAgICAgICBob3N0OiAnbG9jYWxob3N0J1xuICAgICAgICBwb3J0OiA4MDg2XG4gICAgICAgIHByb3RvY29sOiAnaHR0cCdcbiAgICAgICAgdXNlcm5hbWU6ICdub2RlJ1xuICAgICAgICBkYXRhYmFzZTogJ2xvZ2dlcidcbiAgICAgICAgXG4gICAgICB0YWdGaWVsZHM6IHsgK21vZHVsZSwgK2FwcCB9XG5cbiAgICBAc2V0dGluZ3MgPSBkZWZhdWx0c0RlZXAgc2V0dGluZ3MsIEBzZXR0aW5nc1xuXG4gICAgQHRhZ0ZpZWxkcyA9IGtleXMgQHNldHRpbmdzLnRhZ0ZpZWxkc1xuICAgICAgICAgICAgXG4gICAgcmVxdWlyZSEgeyBpbmZsdXg6IHsgSW5mbHV4REI6IGluZmx1eCB9IH1cbiAgICBAY2xpZW50ID0gbmV3IGluZmx1eCBAc2V0dGluZ3MuY29ubmVjdGlvblxuXG4gIGxvZzogKGxvZ0V2ZW50KSAtPlxuICAgICNAY2xpZW50LndyaXRlUG9pbnQoc2VyaWVzTmFtZSwgdmFsdWVzLCB0YWdzLCBbb3B0aW9uc10sIGZ1bmN0aW9uKGVyciwgcmVzcG9uc2UpIHsgfSlcbiAgICByZW1vdmVGb3JiaWRkZW4gPSAtPiBcbiAgICAgIGZvcmJpZGRlbktleXMgPSB7ICt0aW1lLCArbWVhc3VyZW1lbnQgfVxuICAgICAgbWFwS2V5cyBpdCwgKHZhbCxrZXkpIC0+IGlmIGZvcmJpZGRlbktleXNbIGtleSBdIHRoZW4gXCJfXCIgKyBrZXkgZWxzZSBrZXlcblxuICAgIGZsYXR0ZW5WYWxzID0gLT5cbiAgICAgIG1hcFZhbHVlcyBpdCwgKHZhbCxrZXkpIC0+XG4gICAgICAgIGlmIG5vdCB2YWw/IHRoZW4gcmV0dXJuIFwiXCJcbiAgICAgICAgaWYgdmFsP0BAIGluIFsgT2JqZWN0LCBBcnJheSBdIHRoZW4gSlNPTi5zdHJpbmdpZnkgdmFsXG4gICAgICAgIGVsc2UgdmFsXG4gICAgICBcbiAgICBkYXRhID0ge30gPDw8IChmbGF0dGVuVmFscyByZW1vdmVGb3JiaWRkZW4gb21pdCAobG9nRXZlbnQuZGF0YSA8PDwgbG9nRXZlbnQudGFncyksIEB0YWdGaWVsZHMpXG4gICAgdGFncyA9IHJlbW92ZUZvcmJpZGRlbiBwaWNrIGxvZ0V2ZW50LnRhZ3MsIEB0YWdGaWVsZHNcbiAgICBcbiMgICAgY29uc29sZS5sb2cgY29sb3JzLmdyZWVuKCdsb2cnKSwgeyBkYXRhOiBkYXRhLCB0YWdzOiB0YWdzIH1cblxuICAgIEBjbGllbnQud3JpdGVQb2ludHMgWyB7IG1lYXN1cmVtZW50OiBcImxvZ1wiLCBmaWVsZHM6IGRhdGEsIHRhZ3M6IHRhZ3MsIHRpbWU6IG5ldyBEYXRlKCkgfSBdXG4gICAgLmNhdGNoIC0+IGNvbnNvbGUuZXJyb3IgY29sb3JzLnJlZChcImVycm9yXCIpLCBpdC5tZXNzYWdlXG4gICAgXG5cbnJlZGlzID0gZXhwb3J0cy5SZWRpcyA9IEJhY2tib25lLk1vZGVsLmV4dGVuZDQwMDAgZG9cbiAgbmFtZTogJ3JlZGlzJ1xuICBpbml0aWFsaXplOiAoc2V0dGluZ3M9e30pIC0+XG4gICAgXG4gICAgQHNldHRpbmdzID0gZG9cbiAgICAgIGNvbm5lY3Rpb246IFxuICAgICAgICBob3N0OiAnbG9jYWxob3N0J1xuICAgICAgICBwb3J0OiA2Mzc5XG4gICAgICAgIFxuICAgICAgY2hhbm5lbDogJ2xvZydcbiAgICAgIGNoYW5uZWxGaWVsZHM6IHsgK3BpZCwgK21vZHVsZSwgK2FwcCB9XG5cbiAgICBAc2V0dGluZ3MgPSBkZWZhdWx0c0RlZXAgc2V0dGluZ3MsIEBzZXR0aW5nc1xuXG4gICAgQCA8PDwgQHNldHRpbmdzeyBjaGFubmVsLCBjaGFubmVsRmllbGRzIH1cbiAgICBcbiAgICByZWRpcyA9IHJlcXVpcmUgJ3JlZGlzJ1xuICAgIEBjbGllbnQgPSByZWRpcy5jcmVhdGVDbGllbnQgQHNldHRpbmdzLmNvbm5lY3Rpb25cbiAgICBcbiAgbG9nOiAobG9nRXZlbnQpIC0+XG4gICAgY2hhbm5lbE5hbWUgPSBAY2hhbm5lbCArIFwiL1wiICsgKGxtYXAgZG9cbiAgICAgIChwaWNrIGxvZ0V2ZW50LnRhZ3MsIGtleXMgQGNoYW5uZWxGaWVsZHMpXG4gICAgICAodmFsdWUsIGtleSkgLT4ga2V5ICsgXCI6XCIgKyB2YWx1ZVxuICAgICAgKS5qb2luIFwiL1wiXG4gICAgICBcbiAgICBAY2xpZW50LnB1Ymxpc2ggZG9cbiAgICAgIGNoYW5uZWxOYW1lXG4gICAgICBKU09OLnN0cmluZ2lmeSBsb2dFdmVudFxuXG4gICAgXG5kYiA9IGV4cG9ydHMuZGIgPSBleHBvcnRzLk1vbmdvID0gQmFja2JvbmUuTW9kZWwuZXh0ZW5kNDAwMCBkb1xuICBuYW1lOiAnZGInXG4gIGluaXRpYWxpemU6IChzZXR0aW5ncykgLT5cbiAgICBAc2V0dGluZ3MgPSAgeyBuYW1lOiAnbG9nJywgY29sbGVjdGlvbjogJ2xvZycsIGhvc3Q6ICdsb2NhbGhvc3QnLCBwb3J0OiAyNzAxNywgdGFpbDogaC5EYXkgKiAzMCAqIDYgfSA8PDwgc2V0dGluZ3NcbiAgICBAbW9uZ29kYiA9IHJlcXVpcmUgJ21vbmdvZGInXG4gICAgXG4gICAgQGRiID0gbmV3IEBtb25nb2RiLkRiIEBzZXR0aW5ncy5uYW1lLCBuZXcgQG1vbmdvZGIuU2VydmVyKEBzZXR0aW5ncy5ob3N0IG9yICdsb2NhbGhvc3QnLCBAc2V0dGluZ3MucG9ydCBvciAyNzAxNyksIHNhZmU6IHRydWVcbiAgICBAZGIub3BlbigpXG4gICAgQGMgPSBAZGIuY29sbGVjdGlvbiBAc2V0dGluZ3MuY29sbGVjdGlvblxuXG4gICAgQHJlbW92ZVRhaWwoKVxuICAgIHNldEludGVydmFsICh+PiBAcmVtb3ZlVGFpbCgpKSwgaC5Ib3VyXG4gICAgICBcbiAgcmVtb3ZlVGFpbDogKGNiKSAtPlxuICAgIHNwbGl0UG9pbnQgPSBNYXRoLnJvdW5kKChuZXcgRGF0ZSgpLmdldFRpbWUoKSAtIEBzZXR0aW5ncy50YWlsKSAvIDEwMDApLnRvU3RyaW5nKDE2KVxuICAgIEBjLnJlbW92ZSB7IF9pZDogeyAkbHQ6IEBtb25nb2RiLk9iamVjdElkKHNwbGl0UG9pbnQgKyBcIjAwMDAwMDAwMDAwMDAwMDBcIikgfSB9LCBjYlxuICAgICAgICAgICAgXG4gIGxvZzogKGxvZ0V2ZW50KSAtPlxuICAgIGVudHJ5ID0gaC5leHRlbmRtIHsgdGltZTogbmV3IERhdGUoKSB9LCBsb2dFdmVudFxuICAgIGlmIGlzRW1wdHkgZW50cnkuZGF0YSB0aGVuIGRlbGV0ZSBlbnRyeS5kYXRhXG4gICAgQGMuaW5zZXJ0IGVudHJ5XG5cbkZsdWVudCA9IGV4cG9ydHMuRmx1ZW50ID0gQmFja2JvbmUuTW9kZWwuZXh0ZW5kNDAwMCBkb1xuICBuYW1lOiAnZmx1ZW50J1xuICBpbml0aWFsaXplOiAoQHNldHRpbmdzID0geyBob3N0OiAnbG9jYWxob3N0JywgbmFtZTogJ2xvZ2dlcicsIHBvcnQ6IDI0MjI0IH0gKSAtPlxuICAgIEBsb2dnZXIgPSByZXF1aXJlICdmbHVlbnQtbG9nZ2VyJ1xuICAgIEBsb2dnZXIuY29uZmlndXJlIG9zLmhvc3RuYW1lKCkgKyAnLm4uJyArIEBzZXR0aW5ncy5uYW1lLCB7IGhvc3Q6IEBzZXR0aW5ncy5ob3N0LCBwb3J0OiBAc2V0dGluZ3MucG9ydCB9XG4gICAgXG4gIGxvZzogKGxvZ0V2ZW50KSAtPlxuICAgIEBsb2dnZXIuZW1pdCBrZXlzKGxvZ0V2ZW50LnRhZ3MpLmpvaW4oJy4nKSwgaC5leHRlbmQgKEBzZXR0aW5ncy5leHRlbmRQYWNrZXQgb3Ige30pLCBsb2dFdmVudC5kYXRhXG5cblxuU2FpbHMgPSBleHBvcnRzLlNhaWxzID0gQmFja2JvbmUuTW9kZWwuZXh0ZW5kNDAwMCBkb1xuICBuYW1lOiAnc2FpbHMnXG4gIGluaXRpYWxpemU6IChAc2V0dGluZ3MgPSB7IHNhaWxzOiBmYWxzZSB9ICkgLT5cbiAgICBpZiBub3QgQHNldHRpbmdzLnNhaWxzIHRoZW4gdGhyb3cgXCJTYWlscyBpbnN0YW5jZSBtaXNzaW5nXCJcbiAgICBAc2FpbHMgPSBAc2V0dGluZ3Muc2FpbHNcbiAgICBcbiAgbG9nOiAobG9nRXZlbnQpIC0+XG4gICAgQHNhaWxzLnNvY2tldHMuYnJvYWRjYXN0ICdsb2cnLCAnbG9nJywgbG9nRXZlbnRcbiAgICBAc2FpbHMuZW1pdCAnbG9nJywgbG9nRXZlbnRcbiAgICBcblVkcCA9IGV4cG9ydHMuVWRwID0gQmFja2JvbmUuTW9kZWwuZXh0ZW5kNDAwMCBkb1xuICBuYW1lOiAndWRwJ1xuXG4gIGluaXRpYWxpemU6IChAc2V0dGluZ3MgPSB7IGhvc3Q6ICdsb2NhbGhvc3QnLCBwb3J0OiA2MDAwIH0gKSAtPlxuICAgIFVkcEd1biA9IHJlcXVpcmUgJ3VkcC1jbGllbnQnXG5cbiAgICBAZ3VuID0gbmV3IFVkcEd1biBAc2V0dGluZ3MucG9ydCwgQHNldHRpbmdzLmhvc3RcbiAgICBAaG9zdG5hbWUgPSBvcy5ob3N0bmFtZSgpXG5cbiAgbG9nOiAobG9nRXZlbnQpIC0+XG4gICAgQGd1bi5zZW5kIG5ldyBCdWZmZXIgSlNPTi5zdHJpbmdpZnkgXy5leHRlbmQgeyB0eXBlOiAnbm9kZWxvZ2dlcicsIGhvc3Q6IEBob3N0bmFtZSB9LCAoQHNldHRpbmdzLmV4dGVuZFBhY2tldCBvciB7fSksIHsgZGF0YTogbG9nRXZlbnQuZGF0YSwgdGFnczoga2V5cyBsb2dFdmVudC50YWdzIH1cblxuXG5UY3AgPSBleHBvcnRzLlRjcCA9IEJhY2tib25lLk1vZGVsLmV4dGVuZDQwMDAgZG9cbiAgbmFtZTogJ3RjcCdcbiAgaW5pdGlhbGl6ZTogKEBzZXR0aW5ncyA9IHsgaG9zdDogJ2xvY2FsaG9zdCcsIHBvcnQ6IDYwMDEgfSApIC0+XG4gICAgXG4gICAgcmVjb25uZWN0byA9IHJlcXVpcmUoJ2x3ZWIzL3RyYW5zcG9ydHMvcmVjb25uZWN0bycpLnJlY29ubmVjdG9cbiAgICBuc3NvY2tldENsaWVudCA9IHJlcXVpcmUoJ2x3ZWIzL3RyYW5zcG9ydHMvY2xpZW50L25zc29ja2V0JykubnNzb2NrZXRDbGllbnRcblxuICAgIEBjb25uZWN0aW9uID0gbmV3IHJlY29ubmVjdG8gZG9cbiAgICAgIGRlZmF1bHRDaGFubmVsQ2xhc3M6IG5zc29ja2V0Q2xpZW50LmV4dGVuZDQwMDAgZG9cbiAgICAgICAgZGVmYXVsdHM6XG4gICAgICAgICAgaG9zdDogQHNldHRpbmdzLmhvc3RcbiAgICAgICAgICBwb3J0OiBAc2V0dGluZ3MucG9ydFxuICAgICAgICAgIGxvZ2dlcjogQHNldHRpbmdzLmxvZ2dlclxuICBcbiAgbG9nOiAobG9nRXZlbnQpIC0+XG4gICAgQGNvbm5lY3Rpb24uc2VuZCBfLmV4dGVuZCB7IHR5cGU6ICdub2RlbG9nZ2VyJywgaG9zdDogQGhvc3RuYW1lIH0sIChAc2V0dGluZ3MuZXh0ZW5kUGFja2V0IG9yIHt9KSwgeyBkYXRhOiBsb2dFdmVudC5kYXRhLCB0YWdzOiBsb2dFdmVudC50YWdzIH1cbiAgICBcbnRjcFNlcnZlciA9IGV4cG9ydHMudGNwU2VydmVyID0gQmFja2JvbmUuTW9kZWwuZXh0ZW5kNDAwMCBkb1xuICBuYW1lOiAndGNwU2VydmVyJ1xuXG4gIGluaXRpYWxpemU6IChAc2V0dGluZ3MgPSB7IHBvcnQ6IDcwMDAsIGhvc3Q6ICcwLjAuMC4wJyB9ICkgLT5cbiAgICBjbnQgPSAwXG4gICAgQGNsaWVudHMgPSB7fVxuICAgIHNlcnZlciA9IG5ldC5jcmVhdGVTZXJ2ZXIgKHNvY2tldCkgfj5cbiAgICAgIGlkID0gY250KytcbiAgICAgIEBjbGllbnRzW2lkXSA9IHNvY2tldFxuICAgICAgc29ja2V0Lm9uICdjbG9zZScsIH4+IGRlbGV0ZSBAY2xpZW50c1tpZF1cbiAgICAgIHNvY2tldC5vbiAnZXJyb3InLCB+PiBkZWxldGUgQGNsaWVudHNbaWRdXG4gICAgc2VydmVyLmxpc3RlbiBAc2V0dGluZ3MucG9ydCwgQHNldHRpbmdzLmhvc3RcblxuICBsb2c6IChsb2dFdmVudCkgLT5cbiAgICB0cnlcbiAgICAgIEBjbGllbnRzXG4gICAgICAgIHw+IHZhbHVlc1xuICAgICAgICB8PiBtYXAgKGNsaWVudCkgfj5cbiAgICAgICAgICBjbGllbnQud3JpdGUgSlNPTi5zdHJpbmdpZnkoXy5leHRlbmQgeyBob3N0OiBAaG9zdG5hbWUgfSwgKEBzZXR0aW5ncy5leHRlbmRQYWNrZXQgb3Ige30pLCB7IGRhdGE6IGxvZ0V2ZW50LmRhdGEsIHRhZ3M6IGtleXMgbG9nRXZlbnQudGFncyB9KSArIFwiXFxuXCJcblxubW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCcuL2luZGV4JykgPDw8IHJlcXVpcmUoJy4vc2hhcmVkJykgPDw8IG1vZHVsZS5leHBvcnRzXG4iXX0=
