(function(){
  var ref$, empty, map, fold1, keys, values, first, flatten, h, net, Backbone, subscriptionMan, colors, UdpGun, os, util, _, db, Fluent, Udp, Tcp, tcpServer;
  ref$ = require('prelude-ls'), empty = ref$.empty, map = ref$.map, fold1 = ref$.fold1, keys = ref$.keys, values = ref$.values, first = ref$.first, flatten = ref$.flatten;
  h = require('helpers');
  net = require('net');
  Backbone = require('backbone4000');
  subscriptionMan = require('subscriptionman2');
  colors = require('colors');
  UdpGun = require('udp-client');
  os = require('os');
  util = require('util');
  _ = require('underscore');
  module.exports = require('./index');
  db = exports.db = Backbone.Model.extend4000({
    name: 'db',
    initialize: function(settings){
      var mongodb;
      this.settings = h.extendm({
        name: 'log',
        collection: 'log',
        host: 'localhost',
        port: 27017
      }, settings);
      mongodb = require('mongodb');
      this.db = new mongodb.Db(this.settings.name, new mongodb.Server(this.settings.host || 'localhost', this.settings.port || 27017), {
        safe: true
      });
      this.db.open();
      return this.c = this.db.collection(this.settings.collection);
    },
    log: function(logEvent){
      var entry;
      entry = h.extendm({
        time: new Date()
      }, logEvent);
      return this.c.insert(entry);
    }
  });
  Fluent = exports.Fluent = Backbone.Model.extend4000({
    name: 'fluent',
    initialize: function(settings){
      this.settings = settings != null
        ? settings
        : {
          host: 'localhost',
          name: 'logger',
          port: 24224
        };
      this.logger = require('fluent-logger');
      this.logger.configure(os.hostname() + '.n.' + this.settings.name, {
        host: this.settings.host,
        port: this.settings.port
      });
      return console.log("FLUENT INIT");
    },
    log: function(logEvent){
      return this.logger.emit(keys(logEvent.tags).join('.'), h.extend(this.settings.extendPacket || {}, logEvent.data));
    }
  });
  Udp = exports.Udp = Backbone.Model.extend4000({
    name: 'udp',
    initialize: function(settings){
      var UdpGun;
      this.settings = settings != null
        ? settings
        : {
          host: 'localhost',
          port: 6000
        };
      UdpGun = require('udp-client');
      this.gun = new UdpGun(this.settings.port, this.settings.host);
      return this.hostname = os.hostname();
    },
    log: function(logEvent){
      return this.gun.send(new Buffer(JSON.stringify(_.extend({
        type: 'nodelogger',
        host: this.hostname
      }, this.settings.extendPacket || {}, {
        data: logEvent.data,
        tags: keys(logEvent.tags)
      }))));
    }
  });
  Tcp = exports.Tcp = Backbone.Model.extend4000({
    name: 'tcp',
    initialize: function(settings){
      var reconnecto, nssocketClient;
      this.settings = settings != null
        ? settings
        : {
          host: 'localhost',
          port: 6001
        };
      reconnecto = require('lweb3/transports/reconnecto').reconnecto;
      nssocketClient = require('lweb3/transports/client/nssocket').nssocketClient;
      return this.connection = new reconnecto({
        defaultChannelClass: nssocketClient.extend4000({
          defaults: {
            host: this.settings.host,
            port: this.settings.port,
            logger: this.settings.logger
          }
        })
      });
    },
    log: function(logEvent){
      return this.connection.send(_.extend({
        type: 'nodelogger',
        host: this.hostname
      }, this.settings.extendPacket || {}, {
        data: logEvent.data,
        tags: logEvent.tags
      }));
    }
  });
  tcpServer = exports.tcpServer = Backbone.Model.extend4000({
    name: 'tcpServer',
    initialize: function(settings){
      var cnt, server, this$ = this;
      this.settings = settings != null
        ? settings
        : {
          port: 7000,
          host: '0.0.0.0'
        };
      cnt = 0;
      this.clients = {};
      server = net.createServer(function(socket){
        var id;
        id = cnt++;
        this$.clients[id] = socket;
        socket.on('close', function(){
          var ref$, ref1$;
          return ref1$ = (ref$ = this$.clients)[id], delete ref$[id], ref1$;
        });
        return socket.on('error', function(){
          var ref$, ref1$;
          return ref1$ = (ref$ = this$.clients)[id], delete ref$[id], ref1$;
        });
      });
      return server.listen(this.settings.port, this.settings.host);
    },
    log: function(logEvent){
      var this$ = this;
      try {
        return map(function(client){
          return client.write(JSON.stringify(_.extend({
            host: this$.hostname
          }, this$.settings.extendPacket || {}, {
            data: logEvent.data,
            tags: keys(logEvent.tags)
          })) + "\n");
        })(
        values(
        this.clients));
      } catch (e$) {}
    }
  });
}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2xlc2gvY29kaW5nL25vZGVsaWJzL2xvZ2dlcjMvc2VydmVyLmxzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0VBQ0EsSUFBQSxHQUFzRCxPQUF0RCxDQUE4RCxZQUFBLENBQTlELEVBQUUsS0FBa0QsQ0FBQSxDQUFBLENBQXBELElBQUEsQ0FBRSxLQUFGLEVBQVMsR0FBMkMsQ0FBQSxDQUFBLENBQXBELElBQUEsQ0FBUyxHQUFULEVBQWMsS0FBc0MsQ0FBQSxDQUFBLENBQXBELElBQUEsQ0FBYyxLQUFkLEVBQXFCLElBQStCLENBQUEsQ0FBQSxDQUFwRCxJQUFBLENBQXFCLElBQXJCLEVBQTJCLE1BQXlCLENBQUEsQ0FBQSxDQUFwRCxJQUFBLENBQTJCLE1BQTNCLEVBQW1DLEtBQWlCLENBQUEsQ0FBQSxDQUFwRCxJQUFBLENBQW1DLEtBQW5DLEVBQTBDLE9BQVUsQ0FBQSxDQUFBLENBQXBELElBQUEsQ0FBMEM7RUFDMUMsQ0FBRSxDQUFBLENBQUEsQ0FBRSxRQUFRLFNBQUE7RUFDWixHQUFJLENBQUEsQ0FBQSxDQUFFLFFBQVEsS0FBQTtFQUVkLFFBQVMsQ0FBQSxDQUFBLENBQUUsUUFBUSxjQUFBO0VBQ25CLGVBQWdCLENBQUEsQ0FBQSxDQUFFLFFBQVEsa0JBQUQ7RUFHekIsTUFBTyxDQUFBLENBQUEsQ0FBRSxRQUFRLFFBQUE7RUFHakIsTUFBTyxDQUFBLENBQUEsQ0FBRSxRQUFRLFlBQUE7RUFDakIsRUFBRyxDQUFBLENBQUEsQ0FBRSxRQUFRLElBQUE7RUFDYixJQUFLLENBQUEsQ0FBQSxDQUFFLFFBQVEsTUFBQTtFQUNmLENBQUUsQ0FBQSxDQUFBLENBQUUsUUFBUSxZQUFBO0VBRVosTUFBTSxDQUFDLE9BQVEsQ0FBQSxDQUFBLENBQUUsUUFBUSxTQUFEO0VBRXhCLEVBQUcsQ0FBQSxDQUFBLENBQUUsT0FBTyxDQUFDLEVBQUksQ0FBQSxDQUFBLENBQUUsUUFBUSxDQUFDLEtBQUssQ0FBQyxXQUNoQztJQUFBLE1BQU07SUFDTixZ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a0MsQ0FBQTtBQUFBLFlBQTVCLElBQTRCLEVBQXRCLElBQXNCLENBQWpCLFFBQVEsQ0FBQyxJQUFULENBQWlCO0FBQUEsVUFBbkQsQ0FBckQsQ0FBVixDQUFrSCxDQUFBLENBQUEsQ0FBTSxJQUF0STtTQURSO1FBREo7UUFETCxJQUFDLENBQUE7OztFQWRMLENBRHVEIiwic291cmNlc0NvbnRlbnQiOlsiI2F1dG9jb21waWxlXG57IGVtcHR5LCBtYXAsIGZvbGQxLCBrZXlzLCB2YWx1ZXMsIGZpcnN0LCBmbGF0dGVuIH0gPSByZXF1aXJlICdwcmVsdWRlLWxzJ1xuaCA9IHJlcXVpcmUgJ2hlbHBlcnMnXG5uZXQgPSByZXF1aXJlICduZXQnXG5cbkJhY2tib25lID0gcmVxdWlyZSAnYmFja2JvbmU0MDAwJ1xuc3Vic2NyaXB0aW9uTWFuID0gcmVxdWlyZSgnc3Vic2NyaXB0aW9ubWFuMicpXG5cbiMgY29uc29sZSBsb2dnZXJcbmNvbG9ycyA9IHJlcXVpcmUgJ2NvbG9ycydcblxuIyB1ZHAgbG9nZ2VyXG5VZHBHdW4gPSByZXF1aXJlICd1ZHAtY2xpZW50J1xub3MgPSByZXF1aXJlICdvcydcbnV0aWwgPSByZXF1aXJlICd1dGlsJ1xuXyA9IHJlcXVpcmUgJ3VuZGVyc2NvcmUnXG5cbm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZSgnLi9pbmRleCcpXG5cbmRiID0gZXhwb3J0cy5kYiAgPSBCYWNrYm9uZS5Nb2RlbC5leHRlbmQ0MDAwIGRvXG4gIG5hbWU6ICdkYidcbiAgaW5pdGlhbGl6ZTogKHNldHRpbmdzKSAtPlxuICAgIEBzZXR0aW5ncyA9ICBoLmV4dGVuZG0geyBuYW1lOiAnbG9nJywgY29sbGVjdGlvbjogJ2xvZycsIGhvc3Q6ICdsb2NhbGhvc3QnLCBwb3J0OiAyNzAxNyB9LCBzZXR0aW5nc1xuICAgIG1vbmdvZGIgPSByZXF1aXJlICdtb25nb2RiJ1xuICAgIEBkYiA9IG5ldyBtb25nb2RiLkRiIEBzZXR0aW5ncy5uYW1lLCBuZXcgbW9uZ29kYi5TZXJ2ZXIoQHNldHRpbmdzLmhvc3Qgb3IgJ2xvY2FsaG9zdCcsIEBzZXR0aW5ncy5wb3J0IG9yIDI3MDE3KSwgc2FmZTogdHJ1ZVxuICAgIEBkYi5vcGVuKClcbiAgICBAYyA9IEBkYi5jb2xsZWN0aW9uIEBzZXR0aW5ncy5jb2xsZWN0aW9uXG4gICAgXG4gIGxvZzogKGxvZ0V2ZW50KSAtPlxuICAgIGVudHJ5ID0gaC5leHRlbmRtIHsgdGltZTogbmV3IERhdGUoKSB9LCBsb2dFdmVudFxuIyAgICBpZiBlbXB0eSBlbnRyeS5kYXRhIHRoZW4gZGVsZXRlIGVudHJ5LmRhdGFcbiAgICBAYy5pbnNlcnQgZW50cnlcblxuXG5cbkZsdWVudCA9IGV4cG9ydHMuRmx1ZW50ID0gQmFja2JvbmUuTW9kZWwuZXh0ZW5kNDAwMCBkb1xuICBuYW1lOiAnZmx1ZW50J1xuICBpbml0aWFsaXplOiAoQHNldHRpbmdzID0geyBob3N0OiAnbG9jYWxob3N0JywgbmFtZTogJ2xvZ2dlcicsIHBvcnQ6IDI0MjI0IH0gKSAtPlxuICAgIEBsb2dnZXIgPSByZXF1aXJlICdmbHVlbnQtbG9nZ2VyJ1xuICAgIEBsb2dnZXIuY29uZmlndXJlIG9zLmhvc3RuYW1lKCkgKyAnLm4uJyArIEBzZXR0aW5ncy5uYW1lLCB7IGhvc3Q6IEBzZXR0aW5ncy5ob3N0LCBwb3J0OiBAc2V0dGluZ3MucG9ydCB9XG4gICAgY29uc29sZS5sb2cgXCJGTFVFTlQgSU5JVFwiXG4gIGxvZzogKGxvZ0V2ZW50KSAtPlxuICAgIEBsb2dnZXIuZW1pdCBrZXlzKGxvZ0V2ZW50LnRhZ3MpLmpvaW4oJy4nKSwgaC5leHRlbmQgKEBzZXR0aW5ncy5leHRlbmRQYWNrZXQgb3Ige30pLCBsb2dFdmVudC5kYXRhXG5cblxuXG5VZHAgPSBleHBvcnRzLlVkcCA9IEJhY2tib25lLk1vZGVsLmV4dGVuZDQwMDAgZG9cbiAgbmFtZTogJ3VkcCdcblxuICBpbml0aWFsaXplOiAoQHNldHRpbmdzID0geyBob3N0OiAnbG9jYWxob3N0JywgcG9ydDogNjAwMCB9ICkgLT5cbiAgICBVZHBHdW4gPSByZXF1aXJlICd1ZHAtY2xpZW50J1xuXG4gICAgQGd1biA9IG5ldyBVZHBHdW4gQHNldHRpbmdzLnBvcnQsIEBzZXR0aW5ncy5ob3N0XG4gICAgQGhvc3RuYW1lID0gb3MuaG9zdG5hbWUoKVxuXG4gIGxvZzogKGxvZ0V2ZW50KSAtPlxuICAgIEBndW4uc2VuZCBuZXcgQnVmZmVyIEpTT04uc3RyaW5naWZ5IF8uZXh0ZW5kIHsgdHlwZTogJ25vZGVsb2dnZXInLCBob3N0OiBAaG9zdG5hbWUgfSwgKEBzZXR0aW5ncy5leHRlbmRQYWNrZXQgb3Ige30pLCB7IGRhdGE6IGxvZ0V2ZW50LmRhdGEsIHRhZ3M6IGtleXMgbG9nRXZlbnQudGFncyB9XG5cblxuVGNwID0gZXhwb3J0cy5UY3AgPSBCYWNrYm9uZS5Nb2RlbC5leHRlbmQ0MDAwIGRvXG4gIG5hbWU6ICd0Y3AnXG4gIGluaXRpYWxpemU6IChAc2V0dGluZ3MgPSB7IGhvc3Q6ICdsb2NhbGhvc3QnLCBwb3J0OiA2MDAxIH0gKSAtPlxuICAgIFxuICAgIHJlY29ubmVjdG8gPSByZXF1aXJlKCdsd2ViMy90cmFuc3BvcnRzL3JlY29ubmVjdG8nKS5yZWNvbm5lY3RvXG4gICAgbnNzb2NrZXRDbGllbnQgPSByZXF1aXJlKCdsd2ViMy90cmFuc3BvcnRzL2NsaWVudC9uc3NvY2tldCcpLm5zc29ja2V0Q2xpZW50XG5cbiAgICBAY29ubmVjdGlvbiA9IG5ldyByZWNvbm5lY3RvIGRvXG4gICAgICBkZWZhdWx0Q2hhbm5lbENsYXNzOiBuc3NvY2tldENsaWVudC5leHRlbmQ0MDAwIGRvXG4gICAgICAgIGRlZmF1bHRzOlxuICAgICAgICAgIGhvc3Q6IEBzZXR0aW5ncy5ob3N0XG4gICAgICAgICAgcG9ydDogQHNldHRpbmdzLnBvcnRcbiAgICAgICAgICBsb2dnZXI6IEBzZXR0aW5ncy5sb2dnZXJcbiAgXG4gIGxvZzogKGxvZ0V2ZW50KSAtPlxuICAgIEBjb25uZWN0aW9uLnNlbmQgXy5leHRlbmQgeyB0eXBlOiAnbm9kZWxvZ2dlcicsIGhvc3Q6IEBob3N0bmFtZSB9LCAoQHNldHRpbmdzLmV4dGVuZFBhY2tldCBvciB7fSksIHsgZGF0YTogbG9nRXZlbnQuZGF0YSwgdGFnczogbG9nRXZlbnQudGFncyB9XG4gICAgXG50Y3BTZXJ2ZXIgPSBleHBvcnRzLnRjcFNlcnZlciA9IEJhY2tib25lLk1vZGVsLmV4dGVuZDQwMDAoXG4gIG5hbWU6ICd0Y3BTZXJ2ZXInXG5cbiAgaW5pdGlhbGl6ZTogKEBzZXR0aW5ncyA9IHsgcG9ydDogNzAwMCwgaG9zdDogJzAuMC4wLjAnIH0gKSAtPlxuICAgIGNudCA9IDBcbiAgICBAY2xpZW50cyA9IHt9XG4gICAgc2VydmVyID0gbmV0LmNyZWF0ZVNlcnZlciAoc29ja2V0KSB+PlxuICAgICAgaWQgPSBjbnQrK1xuICAgICAgQGNsaWVudHNbaWRdID0gc29ja2V0XG4gICAgICBzb2NrZXQub24gJ2Nsb3NlJywgfj4gZGVsZXRlIEBjbGllbnRzW2lkXVxuICAgICAgc29ja2V0Lm9uICdlcnJvcicsIH4+IGRlbGV0ZSBAY2xpZW50c1tpZF1cbiAgICBzZXJ2ZXIubGlzdGVuIEBzZXR0aW5ncy5wb3J0LCBAc2V0dGluZ3MuaG9zdFxuXG4gIGxvZzogKGxvZ0V2ZW50KSAtPlxuICAgIHRyeVxuICAgICAgQGNsaWVudHNcbiAgICAgICAgfD4gdmFsdWVzXG4gICAgICAgIHw+IG1hcCAoY2xpZW50KSB+PlxuICAgICAgICAgIGNsaWVudC53cml0ZSBKU09OLnN0cmluZ2lmeShfLmV4dGVuZCB7IGhvc3Q6IEBob3N0bmFtZSB9LCAoQHNldHRpbmdzLmV4dGVuZFBhY2tldCBvciB7fSksIHsgZGF0YTogbG9nRXZlbnQuZGF0YSwgdGFnczoga2V5cyBsb2dFdmVudC50YWdzIH0pICsgXCJcXG5cIlxuKVxuIl19
