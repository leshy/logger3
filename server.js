(function(){
  var ref$, lmap, keys, values, isEmpty, defaultsDeep, pick, omit, mapKeys, mapValues, net, colors, os, util, h, Backbone, subscriptionMan, _, objToPairs, map, fold1, first, flatten, hashColors, Influx, redis, db, Fluent, Sails, Udp, Tcp, tcpServer;
  ref$ = require('lodash'), lmap = ref$.map, keys = ref$.keys, values = ref$.values, isEmpty = ref$.isEmpty, defaultsDeep = ref$.defaultsDeep, pick = ref$.pick, omit = ref$.omit, mapKeys = ref$.mapKeys, mapValues = ref$.mapValues;
  net = require('net');
  colors = require('colors');
  os = require('os');
  util = require('util');
  h = require('helpers');
  Backbone = require('backbone4000');
  subscriptionMan = require('subscriptionman2');
  _ = require('underscore');
  ref$ = require('prelude-ls'), objToPairs = ref$.objToPairs, map = ref$.map, fold1 = ref$.fold1, keys = ref$.keys, values = ref$.values, first = ref$.first, flatten = ref$.flatten;
  hashColors = [colors.green, colors.rainbow, colors.yellow, colors.red, colors.blue, colors.cyan, colors.magenta, colors.grey, colors.white];
  exports.Console = Backbone.Model.extend4000({
    name: 'console',
    initialize: function(){
      return this.startTime = process.hrtime()[0];
    },
    parseTags: function(tags){
      return map(function(arg$){
        var tag, value, paintString;
        tag = arg$[0], value = arg$[1];
        paintString = function(value, name){
          if (value === 'fail' || value === 'error' || value === 'err' || value === 'warning' || value === 'warn') {
            return colors.red(value);
          }
          if (value === 'done' || value === 'pass' || value === 'ok' || value === 'success' || value === 'completed') {
            return colors.green(value);
          }
          if (value === 'exec' || value === 'task') {
            return colors.magenta(value);
          }
          if (value === 'GET' || value === 'POST' || value === 'login' || value === 'in' || value === 'out' || value === 'skip') {
            return colors.magenta(value);
          }
          if (name === 'pid') {
            value = hashColors[Number(value) % hashColors.length](String(value));
          }
          return colors.yellow(value);
        };
        if (value === true) {
          return paintString(tag);
        } else {
          return colors.gray(tag) + ":" + paintString(value, tag);
        }
      })(
      objToPairs(
      tags));
    },
    log: function(logEvent){
      var hrtime, tags;
      hrtime = process.hrtime();
      tags = this.parseTags(logEvent.tags);
      return console.log(colors.magenta(process.pid), colors.green((hrtime[0] - this.startTime) + "." + hrtime[1]) + "\t " + tags.join(', ') + "\t" + (logEvent.msg || "-"));
    }
  });
  Influx = exports.Influx = Backbone.Model.extend4000({
    name: 'influx',
    initialize: function(settings){
      var influx;
      settings == null && (settings = {});
      this.settings = {
        connection: {
          host: 'localhost',
          port: 8086,
          protocol: 'http',
          username: 'node',
          database: 'logger'
        },
        tagFields: {
          module: true,
          app: true
        }
      };
      this.settings = defaultsDeep(settings, this.settings);
      this.tagFields = keys(this.settings.tagFields);
      influx = require('influx');
      return this.client = influx(this.settings.connection);
    },
    log: function(logEvent){
      var removeForbidden, flattenVals, data, tags;
      removeForbidden = function(it){
        var forbiddenKeys;
        forbiddenKeys = {
          time: true
        };
        return mapKeys(it, function(val, key){
          if (forbiddenKeys[key]) {
            return "_" + key;
          } else {
            return key;
          }
        });
      };
      flattenVals = function(it){
        return mapValues(it, function(val, key){
          var ref$;
          if ((ref$ = val != null ? val.constructor : void 8) === Object || ref$ === Array) {
            return JSON.stringify(val);
          } else {
            return val;
          }
        });
      };
      data = import$({
        time: new Date()
      }, flattenVals(removeForbidden(omit(import$(logEvent.data, logEvent.tags), this.tagFields))));
      tags = removeForbidden(pick(logEvent.tags, this.tagFields));
      return this.client.writePoint("log", data, tags, function(err, res){
        if (err) {
          return console.error("influxdb logging error", err);
        }
      });
    }
  });
  redis = exports.Redis = Backbone.Model.extend4000({
    name: 'redis',
    initialize: function(settings){
      var ref$, redis;
      settings == null && (settings = {});
      this.settings = {
        connection: {
          host: 'localhost',
          port: 6379
        },
        channel: 'log',
        channelFields: {
          pid: true,
          module: true,
          app: true
        }
      };
      this.settings = defaultsDeep(settings, this.settings);
      this.channel = (ref$ = this.settings).channel;
      this.channelFields = ref$.channelFields;
      redis = require('redis');
      return this.client = redis.createClient(this.settings.connection);
    },
    log: function(logEvent){
      var channelName, ref$;
      channelName = this.channel + "/" + lmap(pick(logEvent.tags, keys(this.channelFields)), function(value, key){
        return key + ":" + value;
      }).join("/");
      return this.client.publish(channelName, JSON.stringify((ref$ = import$(logEvent.data, logEvent.tags), ref$.msg = logEvent.msg, ref$)));
    }
  });
  db = exports.db = exports.Mongo = Backbone.Model.extend4000({
    name: 'db',
    initialize: function(settings){
      var this$ = this;
      this.settings = import$({
        name: 'log',
        collection: 'log',
        host: 'localhost',
        port: 27017,
        tail: h.Day * 30
      }, settings);
      this.mongodb = require('mongodb');
      this.db = new this.mongodb.Db(this.settings.name, new this.mongodb.Server(this.settings.host || 'localhost', this.settings.port || 27017), {
        safe: true
      });
      this.db.open();
      this.c = this.db.collection(this.settings.collection);
      this.removeTail();
      return setInterval(function(){
        return this$.removeTail();
      }, h.Hour);
    },
    removeTail: function(cb){
      var splitPoint;
      splitPoint = Math.round((new Date().getTime() - this.settings.tail) / 1000).toString(16);
      return this.c.remove({
        _id: {
          $lt: this.mongodb.ObjectId(splitPoint + "0000000000000000")
        }
      }, cb);
    },
    log: function(logEvent){
      var entry;
      entry = h.extendm({
        time: new Date()
      }, logEvent);
      if (isEmpty(entry.data)) {
        delete entry.data;
      }
      return this.c.insert(entry);
    }
  });
  Fluent = exports.Fluent = Backbone.Model.extend4000({
    name: 'fluent',
    initialize: function(settings){
      this.settings = settings != null
        ? settings
        : {
          host: 'localhost',
          name: 'logger',
          port: 24224
        };
      this.logger = require('fluent-logger');
      return this.logger.configure(os.hostname() + '.n.' + this.settings.name, {
        host: this.settings.host,
        port: this.settings.port
      });
    },
    log: function(logEvent){
      return this.logger.emit(keys(logEvent.tags).join('.'), h.extend(this.settings.extendPacket || {}, logEvent.data));
    }
  });
  Sails = exports.Sails = Backbone.Model.extend4000({
    name: 'sails',
    initialize: function(settings){
      this.settings = settings != null
        ? settings
        : {
          sails: false
        };
      if (!this.settings.sails) {
        throw "Sails instance missing";
      }
      return this.sails = this.settings.sails;
    },
    log: function(logEvent){
      this.sails.sockets.broadcast('log', 'log', logEvent);
      return this.sails.emit('log', logEvent);
    }
  });
  Udp = exports.Udp = Backbone.Model.extend4000({
    name: 'udp',
    initialize: function(settings){
      var UdpGun;
      this.settings = settings != null
        ? settings
        : {
          host: 'localhost',
          port: 6000
        };
      UdpGun = require('udp-client');
      this.gun = new UdpGun(this.settings.port, this.settings.host);
      return this.hostname = os.hostname();
    },
    log: function(logEvent){
      return this.gun.send(new Buffer(JSON.stringify(_.extend({
        type: 'nodelogger',
        host: this.hostname
      }, this.settings.extendPacket || {}, {
        data: logEvent.data,
        tags: keys(logEvent.tags)
      }))));
    }
  });
  Tcp = exports.Tcp = Backbone.Model.extend4000({
    name: 'tcp',
    initialize: function(settings){
      var reconnecto, nssocketClient;
      this.settings = settings != null
        ? settings
        : {
          host: 'localhost',
          port: 6001
        };
      reconnecto = require('lweb3/transports/reconnecto').reconnecto;
      nssocketClient = require('lweb3/transports/client/nssocket').nssocketClient;
      return this.connection = new reconnecto({
        defaultChannelClass: nssocketClient.extend4000({
          defaults: {
            host: this.settings.host,
            port: this.settings.port,
            logger: this.settings.logger
          }
        })
      });
    },
    log: function(logEvent){
      return this.connection.send(_.extend({
        type: 'nodelogger',
        host: this.hostname
      }, this.settings.extendPacket || {}, {
        data: logEvent.data,
        tags: logEvent.tags
      }));
    }
  });
  tcpServer = exports.tcpServer = Backbone.Model.extend4000({
    name: 'tcpServer',
    initialize: function(settings){
      var cnt, server, this$ = this;
      this.settings = settings != null
        ? settings
        : {
          port: 7000,
          host: '0.0.0.0'
        };
      cnt = 0;
      this.clients = {};
      server = net.createServer(function(socket){
        var id;
        id = cnt++;
        this$.clients[id] = socket;
        socket.on('close', function(){
          var ref$, ref1$;
          return ref1$ = (ref$ = this$.clients)[id], delete ref$[id], ref1$;
        });
        return socket.on('error', function(){
          var ref$, ref1$;
          return ref1$ = (ref$ = this$.clients)[id], delete ref$[id], ref1$;
        });
      });
      return server.listen(this.settings.port, this.settings.host);
    },
    log: function(logEvent){
      var this$ = this;
      try {
        return map(function(client){
          return client.write(JSON.stringify(_.extend({
            host: this$.hostname
          }, this$.settings.extendPacket || {}, {
            data: logEvent.data,
            tags: keys(logEvent.tags)
          })) + "\n");
        })(
        values(
        this.clients));
      } catch (e$) {}
    }
  });
  module.exports = import$(import$(require('./index'), require('./shared')), module.exports);
  function import$(obj, src){
    var own = {}.hasOwnProperty;
    for (var key in src) if (own.call(src, key)) obj[key] = src[key];
    return obj;
  }
}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2xlc2gvY29kaW5nL3Jlc2JvdS9jb3JlL25vZGVfbW9kdWxlcy9sb2dnZXIzL3NlcnZlci5scyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztFQU1FLElBQUEsR0FBQSxPQUFBLENBQUEsUUFBQSxDQUFBLEVBQWUsSUFBZixDQUFBLENBQUEsQ0FBQSxJQUFBLENBQVUsR0FBVixFQUFxQixJQUFyQixDQUFBLENBQUEsQ0FBQSxJQUFBLENBQXFCLElBQXJCLEVBQTJCLE1BQTNCLENBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBMkIsTUFBM0IsRUFBbUMsT0FBbkMsQ0FBQSxDQUFBLENBQUEsSUFBQSxDQUFtQyxPQUFuQyxFQUE0QyxZQUE1QyxDQUFBLENBQUEsQ0FBQSxJQUFBLENBQTRDLFlBQTVDLEVBQTBELElBQTFELENBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBMEQsSUFBMUQsRUFBZ0UsSUFBaEUsQ0FBQSxDQUFBLENBQUEsSUFBQSxDQUFnRSxJQUFoRSxFQUFzRSxPQUF0RSxDQUFBLENBQUEsQ0FBQSxJQUFBLENBQXNFLE9BQXRFLEVBQStFLFNBQS9FLENBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBK0U7RUFFL0UsR0FBQSxDQUFBLENBQUEsQ0FBQSxPQUFBLENBQUEsS0FBQTtFQUNBLE1BQUEsQ0FBQSxDQUFBLENBQUEsT0FBQSxDQUFBLFFBQUE7RUFDQSxFQUFBLENBQUEsQ0FBQSxDQUFBLE9BQUEsQ0FBQSxJQUFBO0VBQ0EsSUFBQSxDQUFBLENBQUEsQ0FBQSxPQUFBLENBQUEsTUFBQTtFQUVTLENBQVQsQ0FBQSxDQUFBLENBQUEsT0FBQSxDQUFBLFNBQUE7RUFFYyxRQUFkLENBQUEsQ0FBQSxDQUFBLE9BQUEsQ0FBQSxjQUFBO0VBQ2tCLGVBQWxCLENBQUEsQ0FBQSxDQUFBLE9BQUEsQ0FBQSxrQkFBQTtFQUNZLENBQVosQ0FBQSxDQUFBLENBQUEsT0FBQSxDQUFBLFlBQUE7RUFHRixJQUFBLEdBQTRELE9BQTVELENBQW9FLFlBQUEsQ0FBcEUsRUFB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QUE1QixJQUE0QixFQUF0QixJQUFzQixDQUFqQixRQUFRLENBQUMsSUFBVCxDQUFpQjtBQUFBLFVBQW5ELENBQXJELENBQVYsQ0FBa0gsQ0FBQSxDQUFBLENBQU0sSUFBdEk7U0FEUjtRQURKO1FBREwsSUFBQyxDQUFBOzs7RUFkTCxDQUFBO0VBbUJGLE1BQU0sQ0FBQyxPQUFRLENBQUEsQ0FBQSxpQkFBRSxRQUFRLFNBQUQsR0FBZ0IsUUFBUSxVQUFELElBQWlCLE1BQU0sQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIiMgYXV0b2NvbXBpbGVcbiNcbiMgdGhpcyBzaG91bGQgdXNlIHNvbWUgcGx1Z2luIHN5c3RlbS4gZGlmZmVyZW50IG91dHB1dHMgaGF2ZSB2ZXJ5IGRpZmZlcm5ldCBhbmQgYmVlZnkgZGVwZW5kZW5jaWVzXG4jIGNoZWNrIGxlZ28gYnV0IGFsc28gaHR0cHM6Ly9naXRodWIuY29tL2M5L2FyY2hpdGVjdFxuXG5yZXF1aXJlISB7IFxuICBsb2Rhc2g6IHsgbWFwOiBsbWFwLCBrZXlzLCB2YWx1ZXMsIGlzRW1wdHksIGRlZmF1bHRzRGVlcCwgcGljaywgb21pdCwgbWFwS2V5cywgbWFwVmFsdWVzIH1cbiAgXG4gIG5ldFxuICBjb2xvcnNcbiAgb3NcbiAgdXRpbFxuXG4gIGhlbHBlcnM6IGhcblxuICBiYWNrYm9uZTQwMDA6IEJhY2tib25lICBcbiAgc3Vic2NyaXB0aW9ubWFuMjogc3Vic2NyaXB0aW9uTWFuXG4gIHVuZGVyc2NvcmU6ICdfJ1xufVxuXG57b2JqLXRvLXBhaXJzLCBtYXAsIGZvbGQxLCBrZXlzLCB2YWx1ZXMsIGZpcnN0LCBmbGF0dGVuIH0gPSByZXF1aXJlICdwcmVsdWRlLWxzJ1xuXG5cblxuaGFzaENvbG9ycyA9IFsgY29sb3JzLmdyZWVuLCBjb2xvcnMucmFpbmJvdywgY29sb3JzLnllbGxvdywgY29sb3JzLnJlZCwgY29sb3JzLmJsdWUsIGNvbG9ycy5jeWFuLCBjb2xvcnMubWFnZW50YSwgY29sb3JzLmdyZXksIGNvbG9ycy53aGl0ZSBdXG5cbmV4cG9ydHMuQ29uc29sZSA9IEJhY2tib25lLk1vZGVsLmV4dGVuZDQwMDAgZG9cbiAgICBuYW1lOiAnY29uc29sZSdcbiAgICBpbml0aWFsaXplOiAtPiBAc3RhcnRUaW1lID0gcHJvY2Vzcy5ocnRpbWUoKVswXVxuICAgIHBhcnNlVGFnczogKHRhZ3MpIC0+XG4gICAgICB0YWdzXG4gICAgICB8PiBvYmotdG8tcGFpcnNcbiAgICAgIHw+IG1hcCAoW3RhZywgdmFsdWVdKSAtPlxuICAgICAgICBcbiAgICAgICAgcGFpbnRTdHJpbmcgPSAodmFsdWUsIG5hbWUpIC0+XG4gICAgICAgICAgaWYgdmFsdWUgaW4gPFsgZmFpbCBlcnJvciBlcnIgd2FybmluZyB3YXJuIF0+IHRoZW4gcmV0dXJuIGNvbG9ycy5yZWQgdmFsdWVcbiAgICAgICAgICBpZiB2YWx1ZSBpbiA8WyBkb25lIHBhc3Mgb2sgc3VjY2VzcyBjb21wbGV0ZWQgXT4gdGhlbiByZXR1cm4gY29sb3JzLmdyZWVuIHZhbHVlXG4gICAgICAgICAgaWYgdmFsdWUgaW4gPFsgZXhlYyB0YXNrIF0+IHRoZW4gcmV0dXJuIGNvbG9ycy5tYWdlbnRhIHZhbHVlXG4gICAgICAgICAgaWYgdmFsdWUgaW4gPFsgR0VUIFBPU1QgbG9naW4gaW4gb3V0IHNraXBdPiB0aGVuIHJldHVybiBjb2xvcnMubWFnZW50YSB2YWx1ZVxuICAgICAgICAgIGlmIG5hbWUgaXMgJ3BpZCcgdGhlbiB2YWx1ZSA9IGhhc2hDb2xvcnNbIE51bWJlcih2YWx1ZSkgJSBoYXNoQ29sb3JzLmxlbmd0aCBdIFN0cmluZyB2YWx1ZVxuICAgICAgICAgIHJldHVybiBjb2xvcnMueWVsbG93IHZhbHVlXG5cbiAgICAgICAgaWYgdmFsdWUgaXMgdHJ1ZSB0aGVuIHBhaW50U3RyaW5nIHRhZ1xuICAgICAgICBlbHNlIFwiI3tjb2xvcnMuZ3JheSB0YWd9OiN7cGFpbnRTdHJpbmcgdmFsdWUsIHRhZ31cIlxuXG4gICAgbG9nOiAobG9nRXZlbnQpIC0+XG4gICAgICBocnRpbWUgPSBwcm9jZXNzLmhydGltZSgpXG4gICAgICB0YWdzID0gQHBhcnNlVGFncyBsb2dFdmVudC50YWdzXG4gICAgICBjb25zb2xlLmxvZyBjb2xvcnMubWFnZW50YShwcm9jZXNzLnBpZCksIGNvbG9ycy5ncmVlbihcIiN7aHJ0aW1lWzBdICAtIEBzdGFydFRpbWV9LiN7aHJ0aW1lWzFdfVwiKSArIFwiXFx0IFwiICsgdGFncy5qb2luKCcsICcpICsgXCJcXHRcIiArIChsb2dFdmVudC5tc2cgb3IgXCItXCIpXG5cblxuSW5mbHV4ID0gZXhwb3J0cy5JbmZsdXggPSBCYWNrYm9uZS5Nb2RlbC5leHRlbmQ0MDAwIGRvXG4gIG5hbWU6ICdpbmZsdXgnXG4gIGluaXRpYWxpemU6IChzZXR0aW5ncz17fSkgLT5cblxuICAgIEBzZXR0aW5ncyA9IGRvXG4gICAgICBjb25uZWN0aW9uOiBcbiAgICAgICAgaG9zdDogJ2xvY2FsaG9zdCdcbiAgICAgICAgcG9ydDogODA4NlxuICAgICAgICBwcm90b2NvbDogJ2h0dHAnXG4gICAgICAgIHVzZXJuYW1lOiAnbm9kZSdcbiAgICAgICAgZGF0YWJhc2U6ICdsb2dnZXInXG4gICAgICAgIFxuICAgICAgdGFnRmllbGRzOiB7ICttb2R1bGUsICthcHAgfVxuXG4gICAgQHNldHRpbmdzID0gZGVmYXVsdHNEZWVwIHNldHRpbmdzLCBAc2V0dGluZ3NcblxuICAgIEB0YWdGaWVsZHMgPSBrZXlzIEBzZXR0aW5ncy50YWdGaWVsZHNcbiAgICAgICAgICAgIFxuICAgIGluZmx1eCA9IHJlcXVpcmUgJ2luZmx1eCdcbiAgICBAY2xpZW50ID0gaW5mbHV4IEBzZXR0aW5ncy5jb25uZWN0aW9uXG5cbiAgbG9nOiAobG9nRXZlbnQpIC0+XG4gICAgI0BjbGllbnQud3JpdGVQb2ludChzZXJpZXNOYW1lLCB2YWx1ZXMsIHRhZ3MsIFtvcHRpb25zXSwgZnVuY3Rpb24oZXJyLCByZXNwb25zZSkgeyB9KVxuICAgIHJlbW92ZUZvcmJpZGRlbiA9IC0+IFxuICAgICAgZm9yYmlkZGVuS2V5cyA9IHsgK3RpbWUgfVxuICAgICAgbWFwS2V5cyBpdCwgKHZhbCxrZXkpIC0+XG4gICAgICAgIGlmIGZvcmJpZGRlbktleXNbIGtleSBdIHRoZW4gXCJfXCIgKyBrZXkgZWxzZSBrZXlcblxuICAgIGZsYXR0ZW5WYWxzID0gLT5cbiAgICAgIG1hcFZhbHVlcyBpdCwgKHZhbCxrZXkpIC0+XG4gICAgICAgIGlmIHZhbD9AQCBpbiBbIE9iamVjdCwgQXJyYXkgXSB0aGVuIEpTT04uc3RyaW5naWZ5IHZhbFxuICAgICAgICBlbHNlIHZhbFxuICAgICAgXG4gICAgZGF0YSA9IHsgdGltZTogbmV3IERhdGUoKSB9IDw8PCAoZmxhdHRlblZhbHMgcmVtb3ZlRm9yYmlkZGVuIG9taXQgKGxvZ0V2ZW50LmRhdGEgPDw8IGxvZ0V2ZW50LnRhZ3MpLCBAdGFnRmllbGRzKVxuICAgIHRhZ3MgPSByZW1vdmVGb3JiaWRkZW4gcGljayBsb2dFdmVudC50YWdzLCBAdGFnRmllbGRzXG4gICAgXG4jICAgIGNvbnNvbGUubG9nIGNvbG9ycy5ncmVlbignbG9nJyksIHsgZGF0YTogZGF0YSwgdGFnczogdGFncyB9XG5cbiAgICBAY2xpZW50LndyaXRlUG9pbnQgZG9cbiAgICAgIFwibG9nXCJcbiAgICAgIGRhdGFcbiAgICAgIHRhZ3NcbiAgICAgIChlcnIscmVzKSAtPiBpZiBlcnIgdGhlbiBjb25zb2xlLmVycm9yIFwiaW5mbHV4ZGIgbG9nZ2luZyBlcnJvclwiLCBlcnJcbiAgICBcblxucmVkaXMgPSBleHBvcnRzLlJlZGlzID0gQmFja2JvbmUuTW9kZWwuZXh0ZW5kNDAwMCBkb1xuICBuYW1lOiAncmVkaXMnXG4gIGluaXRpYWxpemU6IChzZXR0aW5ncz17fSkgLT5cbiAgICBcbiAgICBAc2V0dGluZ3MgPSBkb1xuICAgICAgY29ubmVjdGlvbjogXG4gICAgICAgIGhvc3Q6ICdsb2NhbGhvc3QnXG4gICAgICAgIHBvcnQ6IDYzNzlcbiAgICAgICAgXG4gICAgICBjaGFubmVsOiAnbG9nJ1xuICAgICAgY2hhbm5lbEZpZWxkczogeyArcGlkLCArbW9kdWxlLCArYXBwIH1cblxuICAgIEBzZXR0aW5ncyA9IGRlZmF1bHRzRGVlcCBzZXR0aW5ncywgQHNldHRpbmdzXG5cbiAgICBAIDw8PCBAc2V0dGluZ3N7IGNoYW5uZWwsIGNoYW5uZWxGaWVsZHMgfVxuICAgIFxuICAgIHJlZGlzID0gcmVxdWlyZSAncmVkaXMnXG4gICAgQGNsaWVudCA9IHJlZGlzLmNyZWF0ZUNsaWVudCBAc2V0dGluZ3MuY29ubmVjdGlvblxuICAgIFxuICBsb2c6IChsb2dFdmVudCkgLT5cbiAgICBjaGFubmVsTmFtZSA9IEBjaGFubmVsICsgXCIvXCIgKyAobG1hcCBkb1xuICAgICAgKHBpY2sgbG9nRXZlbnQudGFncywga2V5cyBAY2hhbm5lbEZpZWxkcylcbiAgICAgICh2YWx1ZSwga2V5KSAtPiBrZXkgKyBcIjpcIiArIHZhbHVlXG4gICAgICApLmpvaW4gXCIvXCJcbiAgICAgIFxuICAgIEBjbGllbnQucHVibGlzaCBkb1xuICAgICAgY2hhbm5lbE5hbWVcbiAgICAgIEpTT04uc3RyaW5naWZ5IGxvZ0V2ZW50LmRhdGEgPDw8IGxvZ0V2ZW50LnRhZ3MgPDw8IG1zZzogbG9nRXZlbnQubXNnXG5cbiAgICBcbmRiID0gZXhwb3J0cy5kYiA9IGV4cG9ydHMuTW9uZ28gPSBCYWNrYm9uZS5Nb2RlbC5leHRlbmQ0MDAwIGRvXG4gIG5hbWU6ICdkYidcbiAgaW5pdGlhbGl6ZTogKHNldHRpbmdzKSAtPlxuICAgIEBzZXR0aW5ncyA9ICB7IG5hbWU6ICdsb2cnLCBjb2xsZWN0aW9uOiAnbG9nJywgaG9zdDogJ2xvY2FsaG9zdCcsIHBvcnQ6IDI3MDE3LCB0YWlsOiBoLkRheSAqIDMwIH0gPDw8IHNldHRpbmdzXG4gICAgQG1vbmdvZGIgPSByZXF1aXJlICdtb25nb2RiJ1xuICAgIFxuICAgIEBkYiA9IG5ldyBAbW9uZ29kYi5EYiBAc2V0dGluZ3MubmFtZSwgbmV3IEBtb25nb2RiLlNlcnZlcihAc2V0dGluZ3MuaG9zdCBvciAnbG9jYWxob3N0JywgQHNldHRpbmdzLnBvcnQgb3IgMjcwMTcpLCBzYWZlOiB0cnVlXG4gICAgQGRiLm9wZW4oKVxuICAgIEBjID0gQGRiLmNvbGxlY3Rpb24gQHNldHRpbmdzLmNvbGxlY3Rpb25cblxuICAgIEByZW1vdmVUYWlsKClcbiAgICBzZXRJbnRlcnZhbCAofj4gQHJlbW92ZVRhaWwoKSksIGguSG91clxuICAgICAgXG4gIHJlbW92ZVRhaWw6IChjYikgLT5cbiAgICBzcGxpdFBvaW50ID0gTWF0aC5yb3VuZCgobmV3IERhdGUoKS5nZXRUaW1lKCkgLSBAc2V0dGluZ3MudGFpbCkgLyAxMDAwKS50b1N0cmluZygxNilcbiAgICBAYy5yZW1vdmUgeyBfaWQ6IHsgJGx0OiBAbW9uZ29kYi5PYmplY3RJZChzcGxpdFBvaW50ICsgXCIwMDAwMDAwMDAwMDAwMDAwXCIpIH0gfSwgY2JcbiAgICAgICAgICAgIFxuICBsb2c6IChsb2dFdmVudCkgLT5cbiAgICBlbnRyeSA9IGguZXh0ZW5kbSB7IHRpbWU6IG5ldyBEYXRlKCkgfSwgbG9nRXZlbnRcbiAgICBpZiBpc0VtcHR5IGVudHJ5LmRhdGEgdGhlbiBkZWxldGUgZW50cnkuZGF0YVxuICAgIEBjLmluc2VydCBlbnRyeVxuXG5GbHVlbnQgPSBleHBvcnRzLkZsdWVudCA9IEJhY2tib25lLk1vZGVsLmV4dGVuZDQwMDAgZG9cbiAgbmFtZTogJ2ZsdWVudCdcbiAgaW5pdGlhbGl6ZTogKEBzZXR0aW5ncyA9IHsgaG9zdDogJ2xvY2FsaG9zdCcsIG5hbWU6ICdsb2dnZXInLCBwb3J0OiAyNDIyNCB9ICkgLT5cbiAgICBAbG9nZ2VyID0gcmVxdWlyZSAnZmx1ZW50LWxvZ2dlcidcbiAgICBAbG9nZ2VyLmNvbmZpZ3VyZSBvcy5ob3N0bmFtZSgpICsgJy5uLicgKyBAc2V0dGluZ3MubmFtZSwgeyBob3N0OiBAc2V0dGluZ3MuaG9zdCwgcG9ydDogQHNldHRpbmdzLnBvcnQgfVxuICAgIFxuICBsb2c6IChsb2dFdmVudCkgLT5cbiAgICBAbG9nZ2VyLmVtaXQga2V5cyhsb2dFdmVudC50YWdzKS5qb2luKCcuJyksIGguZXh0ZW5kIChAc2V0dGluZ3MuZXh0ZW5kUGFja2V0IG9yIHt9KSwgbG9nRXZlbnQuZGF0YVxuXG5cblNhaWxzID0gZXhwb3J0cy5TYWlscyA9IEJhY2tib25lLk1vZGVsLmV4dGVuZDQwMDAgZG9cbiAgbmFtZTogJ3NhaWxzJ1xuICBpbml0aWFsaXplOiAoQHNldHRpbmdzID0geyBzYWlsczogZmFsc2UgfSApIC0+XG4gICAgaWYgbm90IEBzZXR0aW5ncy5zYWlscyB0aGVuIHRocm93IFwiU2FpbHMgaW5zdGFuY2UgbWlzc2luZ1wiXG4gICAgQHNhaWxzID0gQHNldHRpbmdzLnNhaWxzXG4gICAgXG4gIGxvZzogKGxvZ0V2ZW50KSAtPlxuICAgIEBzYWlscy5zb2NrZXRzLmJyb2FkY2FzdCAnbG9nJywgJ2xvZycsIGxvZ0V2ZW50XG4gICAgQHNhaWxzLmVtaXQgJ2xvZycsIGxvZ0V2ZW50XG4gICAgXG5VZHAgPSBleHBvcnRzLlVkcCA9IEJhY2tib25lLk1vZGVsLmV4dGVuZDQwMDAgZG9cbiAgbmFtZTogJ3VkcCdcblxuICBpbml0aWFsaXplOiAoQHNldHRpbmdzID0geyBob3N0OiAnbG9jYWxob3N0JywgcG9ydDogNjAwMCB9ICkgLT5cbiAgICBVZHBHdW4gPSByZXF1aXJlICd1ZHAtY2xpZW50J1xuXG4gICAgQGd1biA9IG5ldyBVZHBHdW4gQHNldHRpbmdzLnBvcnQsIEBzZXR0aW5ncy5ob3N0XG4gICAgQGhvc3RuYW1lID0gb3MuaG9zdG5hbWUoKVxuXG4gIGxvZzogKGxvZ0V2ZW50KSAtPlxuICAgIEBndW4uc2VuZCBuZXcgQnVmZmVyIEpTT04uc3RyaW5naWZ5IF8uZXh0ZW5kIHsgdHlwZTogJ25vZGVsb2dnZXInLCBob3N0OiBAaG9zdG5hbWUgfSwgKEBzZXR0aW5ncy5leHRlbmRQYWNrZXQgb3Ige30pLCB7IGRhdGE6IGxvZ0V2ZW50LmRhdGEsIHRhZ3M6IGtleXMgbG9nRXZlbnQudGFncyB9XG5cblxuVGNwID0gZXhwb3J0cy5UY3AgPSBCYWNrYm9uZS5Nb2RlbC5leHRlbmQ0MDAwIGRvXG4gIG5hbWU6ICd0Y3AnXG4gIGluaXRpYWxpemU6IChAc2V0dGluZ3MgPSB7IGhvc3Q6ICdsb2NhbGhvc3QnLCBwb3J0OiA2MDAxIH0gKSAtPlxuICAgIFxuICAgIHJlY29ubmVjdG8gPSByZXF1aXJlKCdsd2ViMy90cmFuc3BvcnRzL3JlY29ubmVjdG8nKS5yZWNvbm5lY3RvXG4gICAgbnNzb2NrZXRDbGllbnQgPSByZXF1aXJlKCdsd2ViMy90cmFuc3BvcnRzL2NsaWVudC9uc3NvY2tldCcpLm5zc29ja2V0Q2xpZW50XG5cbiAgICBAY29ubmVjdGlvbiA9IG5ldyByZWNvbm5lY3RvIGRvXG4gICAgICBkZWZhdWx0Q2hhbm5lbENsYXNzOiBuc3NvY2tldENsaWVudC5leHRlbmQ0MDAwIGRvXG4gICAgICAgIGRlZmF1bHRzOlxuICAgICAgICAgIGhvc3Q6IEBzZXR0aW5ncy5ob3N0XG4gICAgICAgICAgcG9ydDogQHNldHRpbmdzLnBvcnRcbiAgICAgICAgICBsb2dnZXI6IEBzZXR0aW5ncy5sb2dnZXJcbiAgXG4gIGxvZzogKGxvZ0V2ZW50KSAtPlxuICAgIEBjb25uZWN0aW9uLnNlbmQgXy5leHRlbmQgeyB0eXBlOiAnbm9kZWxvZ2dlcicsIGhvc3Q6IEBob3N0bmFtZSB9LCAoQHNldHRpbmdzLmV4dGVuZFBhY2tldCBvciB7fSksIHsgZGF0YTogbG9nRXZlbnQuZGF0YSwgdGFnczogbG9nRXZlbnQudGFncyB9XG4gICAgXG50Y3BTZXJ2ZXIgPSBleHBvcnRzLnRjcFNlcnZlciA9IEJhY2tib25lLk1vZGVsLmV4dGVuZDQwMDAgZG9cbiAgbmFtZTogJ3RjcFNlcnZlcidcblxuICBpbml0aWFsaXplOiAoQHNldHRpbmdzID0geyBwb3J0OiA3MDAwLCBob3N0OiAnMC4wLjAuMCcgfSApIC0+XG4gICAgY250ID0gMFxuICAgIEBjbGllbnRzID0ge31cbiAgICBzZXJ2ZXIgPSBuZXQuY3JlYXRlU2VydmVyIChzb2NrZXQpIH4+XG4gICAgICBpZCA9IGNudCsrXG4gICAgICBAY2xpZW50c1tpZF0gPSBzb2NrZXRcbiAgICAgIHNvY2tldC5vbiAnY2xvc2UnLCB+PiBkZWxldGUgQGNsaWVudHNbaWRdXG4gICAgICBzb2NrZXQub24gJ2Vycm9yJywgfj4gZGVsZXRlIEBjbGllbnRzW2lkXVxuICAgIHNlcnZlci5saXN0ZW4gQHNldHRpbmdzLnBvcnQsIEBzZXR0aW5ncy5ob3N0XG5cbiAgbG9nOiAobG9nRXZlbnQpIC0+XG4gICAgdHJ5XG4gICAgICBAY2xpZW50c1xuICAgICAgICB8PiB2YWx1ZXNcbiAgICAgICAgfD4gbWFwIChjbGllbnQpIH4+XG4gICAgICAgICAgY2xpZW50LndyaXRlIEpTT04uc3RyaW5naWZ5KF8uZXh0ZW5kIHsgaG9zdDogQGhvc3RuYW1lIH0sIChAc2V0dGluZ3MuZXh0ZW5kUGFja2V0IG9yIHt9KSwgeyBkYXRhOiBsb2dFdmVudC5kYXRhLCB0YWdzOiBrZXlzIGxvZ0V2ZW50LnRhZ3MgfSkgKyBcIlxcblwiXG5cbm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZSgnLi9pbmRleCcpIDw8PCByZXF1aXJlKCcuL3NoYXJlZCcpIDw8PCBtb2R1bGUuZXhwb3J0c1xuIl19
